### Google Auth
You need your GoogleService-Info.plist from your iOS Client ID from Google Cloud that was autogenerated by Firebase when you added Sign-In with Google!
* If your GoogleService-Info.plist is missing the **required** key value pairs for the following:
    * API_KEY, GCM_SENDER_ID, PROJECT_ID, STORAGE_BUCKER, GOOGLE_APP_ID, IS_ADS_ENABLED, IS_ANALYTICS_ENABLED, IS_APPINVITE_ENABLED, IS_APPINVITE_ENABLED, or IS_GCM_ENABLED
    * Then you can check the version I uploaded to AWS Secrets Manager in us-west-1, which was converted to a string with:
        * ```awk '{printf "%s\\n", $0}' APP/ios/GoogleService-Info.plist```
        * Convert it back to a file with (USE SINGLE QUOTES):
            * ```echo '...' | sed 's/\\n/\n/g' > APP/ios/GoogleService-Info.plist```

The steps are different if you are running the project locally vs for a cloud build. (I know it's stupid)

* For LOCAL builds (npx expo run:ios):
    * Make sure you have GoogleService-Info.plist under StreamTrack/APP/app/ios
    * In APP/app.config.js:
        * Uncomment: googleServicesFile: './ios/GoogleService-Info.plist', // LOCAL npx expo run:ios
        * Comment out: googleServicesFile: process.env.GOOGLE_SERVICES_PLIST, // EAS Build
        * Do NOT use a ternary operator or fallback or anything. This is an Expo EAS Build bug 
    * Open ios/StreamTrack.xcworkspace in XCode
        * Click the root StreamTrack folder on the left with the folders
        * Then click the StreamTrack under targets in the inner left window
        * Go to Build Phases > Copy Bundle Resources
        * Click the **plus** > Add Other
            * Find the plist in your ios folder
            * Destination: Copy items if needed
            * Added folders: Create folder references
* For CLOUD EXPO EAS BUILDS (npx eas build -p ios --profile production):
    * In APP/app.config.js:
        * Uncomment: googleServicesFile: process.env.GOOGLE_SERVICES_PLIST, // EAS Build
        * Comment out: googleServicesFile: './ios/GoogleService-Info.plist', // LOCAL npx expo run:ios
        * Do NOT use a ternary operator or fallback or anything. This is an Expo EAS Build bug
    * Open ios/StreamTrack.xcworkspace in XCode
        * Click the root StreamTrack folder on the left with the folders
        * Then click the StreamTrack under targets in the inner left window
        * Go to Build Phases > Copy Bundle Resources
        * REMOVE the line with GoogleService-Info.plist with the **minus**
        * On the left with the folders, right click on GoogleService-Info.plist
            * Delete > Remove Reference
            * The project is configured for Expo EAS to copy this file there for you if you follow the rest of the steps
    * How to get the plist into the ENV:
        * Go to the [Expo EAS website](https://expo.dev)
        * Go to your project
        * Go to environmental variables under propject settings
        * Add variable GOOGLE_SERVICES_PLIST with the **file** upload button as a Secret in both dev and production

If you have problems and you followed the steps correctly, see Debugging XCode project at the bottom

### To run:
```sh
cd StreamTrack/APP
```

Things have changed so when developing try to just run it on the iOS 18.5 simulator.
Make sure you are signed into iCloud on the simulator for sign in with Apple
```sh
npx expo run:ios
```

Older way:
```sh
npm start
```

or
```sh
npx expo start
```

To clear cache:
```sh
npx expo start -c
```

### To connect to iPhone:

Can't really do now, need to change a few things and comment out the Sign In with Apple/Google buttons.

In StreamTrack/APP/.env.local, change DATA_API_URL from localhost to the computer's or servers IP Address.

In StreamTrack/API/Properties/launchSettings.json, change localhost to 0.0.0.0 to allow anyone on the same network. Mainly just in the HTTP section.

Scan the QR code on your phone


### EAS Build (Need an Apple Developer account and to register an Identifier for your app):

Be fully commited to GitHub
```sh
npx eas build:configure
```

Choose iOS

Secrets needed to be added to the EAS ENV (.env.local) (see the .env.example for what is needed):
```sh
eas env:create --name SECRET_NAME --value "..."
```
You can only do one at a time. Use the spacebar to pick the options. I did Development & Production


Make sure you are in the Git branch you want to build from, then build (by default it pulls from your default GitHub branch):
```sh
npx eas build -p ios --profile production
```

Submit (to App Store Connect, not to the App Store and does NOT request a review)
```sh
npx eas submit --platform ios
```

#### Debugging XCode project

Try opening the ios StreamTrack.xcworkspace in XCode and going to Product > Clean Build Folder

Then clean up
```sh
cd ios
rm -rf Pods Podfile.lock ~/Library/Developer/Xcode/DerivedData
pod install --repo-update
cd ..
```